<html>
<head>

[ZONE WEBDESK:HEAD]

[CSS:REF]

<style type="text/css">

[ZONE WEBDESK:CSS]


[CSS:CODE]</style>

<script src="WHAT/Layout/DHTMLapi.js"></script>
<script src="WHAT/Layout/AnchorPosition.js"></script>
<script src="WHAT/Layout/geometry.js"></script>

[JS:REF]

<script>
    [JS:CODE]


var isMBarStatic = [IF IsMBarStatic]true[ENDIF IsMBarStatic][IFNOT IsMBarStatic]false[ENDIF IsMBarStatic];

var isOpen = [IF IsMBarStatic]true[ENDIF IsMBarStatic][IFNOT IsMBarStatic]false[ENDIF IsMBarStatic];


function alternMBar() {

  if (isMBarStatic) {
    isMBarStatic = false;
    isOpen = false;
    document.getElementById('wdcmdtext').src = "[IMG:wd_release_menu.gif]";
  } else {
    isMBarStatic = true;
    isOpen = true;
    document.getElementById('wdcmdtext').src = "[IMG:wd_fixe_menu.gif]";
  }
  computefbodywh();
}

function computefbodywh() {

  var bodH = getFrameHeight();
  var bodW = getFrameWidth();

  var topH = getObjectHeight(document.getElementById('wdtitle'));
  var wor = (isOpen ? 0.2 : 0.0);
  var wdrift = 0.02;

  var md = document.getElementById('wdmenu');
  md.style.height = 'auto';
  if (isMBarStatic) {
    md.style.position = 'relative';
    md.style.top = 0;
    md.style.left = 0;

    var ww = bodW;
    document.getElementById('wdmenu').style.height = bodH - topH;
    document.getElementById('wdmenu').style.width = parseInt(ww * wor); 
    document.getElementById('wdmenu').style.display = (isOpen?'block':'none');
    document.getElementById('wdbody').style.width =parseInt(ww * (1 - (wor + wdrift)));
    if (currentApp>-1) {
      document.getElementById('fbody'+currentApp).style.height = bodH - topH;
      document.getElementById('fbody'+currentApp).style.width = parseInt(ww * (1 - (wor + wdrift)));
    }
    document.getElementById('wdmbarmng').src = (isOpen?"[IMG:wd_left_bar.gif]":"[IMG:wd_right_bar.gif]");

  } else {

    md.style.position = 'absolute';
    md.style.top = topH;
    md.style.width =  parseInt(bodW * wor);
    
    document.getElementById('wdbody').style.width =parseInt(bodW);
    if (currentApp>-1) {
      document.getElementById('fbody'+currentApp).style.width = parseInt(bodW);
      document.getElementById('fbody'+currentApp).style.height = bodH - topH;
    }    
    if (isOpen)  md.style.display = 'block';
    else md.style.display = 'none';

    document.getElementById('wdmbarmng').src = (isOpen?"[IMG:wd_close_bar.gif]":"[IMG:wd_open_bar.gif]");

  }

  setcurtime();
    
}

var currentApp = -1;
var currentIdApp = -1;
function runapp( idapp, sidapp, params) {
  
  if (!params) params='';

  if (currentApp>-1) {
    document.getElementById('app'+currentIdApp).className = 'app';
    document.getElementById('fbody'+currentApp).style.display = 'none';
  }

  currentIdApp = idapp;
  currentApp = idapp; //(idapp>10000?0:idapp);
  var fapp = document.getElementById('fbody'+currentApp);

  if (fapp.src=='about:blank' || currentApp==0) {
    fapp.src = '[CORE_BASEURL]app='+sidapp+params;
  }
  fapp.style.display = 'block';
  
  document.getElementById('app'+idapp).className = 'app app_selected';
  document.getElementById('wdappsel').innerHTML = document.getElementById('app'+idapp).innerHTML;

  if (!isMBarStatic) isOpen = false;
  computefbodywh();

}   
  
function setcurtime() {
  var dat = new Date();
  var dstr = dat.toLocaleDateString()+" "+dat.getHours()+":"+dat.getMinutes();
  document.getElementById('curdate').innerHTML = dstr;
  setTimeout("setcurtime()", 20*1000);
}

</script>  
</head>
<body onload="computefbodywh()" onresize="computefbodywh()">

<div id="wdtitle" class="wdtitle">
<table style="width:100%"><tr>
<td style="text-align:left; "><img onclick="isOpen = !isOpen; computefbodywh();" style="vertical-align:bottom;"  class="small_button" title="[TEXT:wd open/close menu]" id="wdmbarmng" src="[IFNOT IsMBarStatic][IMG:wd_open_bar.gif][ENDIF IsMBarStatic][IF IsMBarStatic][IMG:wd_right_bar.gif][ENDIF IsMBarStatic]"> <span id="wdappsel">Agenda</span></td>
<td style="text-align:center">[title]</td>
<td style="text-align:right"><span id="curdate">jj:mm:yy hh:mm</span> | [userDomain] | [userRealName] <img id="logo" onclick="document.authent.submit()" title="[TEXT:Click here to login]" class="small_button" src="[IMG:wdconnect.gif]"></td>
</tr></table>
</div>

<div id="wdmenu" class="wdmenu" style="float:left; width:1px;">

[BLOCK appList]
<div id="app[id]" class="app" onmouseover="if (currentIdApp!=[id]) this.className='app app_over'" onmouseout="if (currentIdApp!=[id]) this.className='app'" title="[description]" onclick="runapp([id], '[name]', '[params]')"><img src="[iconsrc]" style="width:16px; vertical-align:baseline">&nbsp;[short_name]</div>[ENDBLOCK appList]

<div class="app">&nbsp;</div>

[BLOCK specialAppList]
<div id="app[id]" class="app" onmouseover="if (currentIdApp!=[id]) this.className='app app_over'" onmouseout="if (currentIdApp!=[id]) this.className='app'" title="[description]" onclick="runapp([id], '[name]', '[params]')"><img src="[iconsrc]" style="width:16px; vertical-align:baseline">&nbsp;[short_name]</div>[ENDBLOCK specialAppList]

<div style="text-align:right; font-size:80%; border-top:1px solid #CFCFCF"  ><img class="small_button" onclick="alternMBar();" id="wdcmdtext" src="[IF IsMBarStatic][IMG:wd_fixe_menu.gif][ENDIF IsMBarStatic][IFNOT IsMBarStatic][IMG:wd_release_menu.gif][ENDIF IsMBarStatic]" title="[TEXT:wd fixe/release menu]"></div>
</div>


<div id="wdbody" style="float:left; background:lightblue; border:0px; width:5px;">
[BLOCK appListBody]<iframe id="fbody[id]" name="fbody[id]"  style="display:none; border:0px; background:blue;" src="about:blank" scrolling="needed"></iframe>
[ENDBLOCK appListBody]
[BLOCK specialAppListBody]<iframe id="fbody[id]" name="fbody[id]"  style="display:none; border:0px; background:blue;" src="about:blank" scrolling="needed"></iframe></div>
[ENDBLOCK specialAppListBody]

<form style="display:inline" action="index.php?sole=Y&&app=AUTHENT&action=LOGOUT" method="POST" name="authent">
  <input type="hidden" name="SeenBefore" value="1">
  <input type="hidden" name="logout" value="Y">
  <input type="hidden" name="rapp" value="WEBDESK">
  <input type="hidden" name="raction" value="MAIN">
  <input type="hidden" name="rurl" value="[CORE_STANDURL]">
  <input type="hidden" name="OldAuth" value="[PHP_AUTH_USER]">
</form>

<script>
// Load default app
runapp([defid], '[defname]', '[defparams]');
</script>
</body>
</html>
